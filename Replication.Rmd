---
title: Exploratory Data Analysis
---


```{r, include=FALSE}

knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)

```


```{r setup}

devtools::load_all()

library(tidyverse)

library(lubridate)

theme_set(theme_bw() +
            theme(legend.position = "bottom",
                  legend.title = element_blank()))

```


```{r import_data}

data("sp_data")

```

```{r feature_engineering}

sp_data = sp_data %>% 
  mutate(sp_spread = (t12_eps_aggte / spx_index) * 100 - us_gov_yield_10_y)

```


# Replication

```{r plot_pe}

sp_data %>% 
  filter(date >= as.Date("2000-01-01")) %>% 
  ggplot(aes(x = date, y = indx_general_pe_ratio)) + 
  geom_line() + 
  xlab(NULL) + ylab(NULL) + ggtitle("PE multiple - S&P 500")

```


```{r plot_sp_spread}

sp_data %>% 
  ggplot(aes(x = date, y = sp_spread)) + 
  geom_line() + 
  xlab(NULL) + ylab(NULL) + ggtitle("SP spread")

```


```{r plot_sp_spread_vs_other_spreads}

sp_data %>% 
  select(date, sp_spread, inv_grade_spread, high_yield_spread) %>% 
  filter(date >= as.Date("2000-01-01")) %>% 
  pivot_longer(-date) %>% 
  ggplot(aes(x = date, y = value, color = name)) + 
  geom_line() + 
  xlab(NULL) + ylab(NULL) + ggtitle("Spreads comparison")

```





